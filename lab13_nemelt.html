<!DOCTYPE html>
<html>
<head>
  <title>AR.js + THREE.js Rotating Cube</title>

  <!-- A-Frame + AR.js -->
  <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js/aframe/build/aframe-ar.js"></script>

  <!-- THREE.js -->
  <script type="module">
    import * as THREE from "https://cdn.jsdelivr.net/npm/three@0.165.0/build/three.module.js";

    window.onload = function () {
      const marker = document.querySelector("a-marker");

      let cube = null;

      // Add cube when marker is found
      marker.addEventListener("markerFound", () => {
        console.log("Marker detected!");

        const scene = marker.object3D;

        // Create cube once
        if (!cube) {
          const geometry = new THREE.BoxGeometry(1, 1, 1);
          const material = new THREE.MeshNormalMaterial();
          cube = new THREE.Mesh(geometry, material);
          cube.position.set(0, 0.5, 0);
          scene.add(cube);
        }
      });

      // Animation loop
      AFRAME.registerComponent("rotate-cube", {
        tick: function () {
          if (cube) {
            cube.rotation.x += 0.02;
            cube.rotation.y += 0.02;
          }
        }
      });
    };
  </script>
</head>

<body style="margin:0; overflow:hidden;">
  <a-scene embedded arjs rotate-cube>
    <a-marker preset="hiro"></a-marker>
    <a-entity camera></a-entity>
  </a-scene>
</body>
</html>
